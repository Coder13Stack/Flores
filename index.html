<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Una sorpresa para ti </title>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Poppins:wght@300;600&display=swap" rel="stylesheet">
    <style>
        body {
            margin: 0;
            overflow: hidden; /* Importante para que no haya scroll en el 3D */
            font-family: 'Poppins', sans-serif;
            background-color: #000; /* Fondo negro mientras carga el 3D */
        }

        /* El contenedor 3D va al fondo */
        #canvas-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }

        /* La interfaz de usuario flota sobre el 3D */
        #ui-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10; /* Por encima del canvas 3D */
            pointer-events: none; /* Permite que los clicks pasen si no hay botones */
        }

        .contenido-ui {
            background: rgba(255, 255, 255, 0.1); /* Muy transparente */
            backdrop-filter: blur(10px);
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
            pointer-events: auto; /* Reactiva los clicks dentro de la caja */
            transition: all 0.8s ease;
        }

        h1 {
            font-family: 'Dancing Script', cursive;
            font-size: 3.5rem;
            margin-bottom: 20px;
            text-shadow: 0 0 10px #ff69b4, 0 0 20px #ff69b4;
        }

        h2 {
             font-family: 'Dancing Script', cursive;
             font-size: 2.5rem;
             color: #ff69b4;
        }
        p { font-size: 1.2rem; }

        button {
            padding: 12px 35px;
            font-size: 1.2rem;
            cursor: pointer;
            border: none;
            border-radius: 50px;
            margin: 15px;
            font-family: 'Poppins', sans-serif;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        #btnSi {
            background: linear-gradient(45deg, #ff4d6d, #ff8fa3);
            color: white;
            box-shadow: 0 0 15px rgba(255, 77, 109, 0.5);
        }
        #btnSi:hover { transform: scale(1.1); box-shadow: 0 0 25px rgba(255, 77, 109, 0.8); }

        #btnNo { background-color: rgba(255,255,255,0.8); color: #333; position: relative; }

        .hidden {
            opacity: 0;
            pointer-events: none;
            transform: translateY(-20px);
        }
    </style>
</head>
<body>

    <div id="canvas-container"></div>

    <div id="ui-container">
        <div id="pregunta" class="contenido-ui">
            <h1>驴Me quieres?</h1>
            <p>Tengo una pregunta importante...</p>
            <div style="margin-top: 30px;">
                <button id="btnSi">隆S铆, claro! わ</button>
                <button id="btnNo">No</button>
            </div>
        </div>

        <div id="mensajeFinal" class="contenido-ui hidden">
            <h2>隆Lo sab铆a! </h2>
            <p>Mira c贸mo el universo florece para ti...</p>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

    <script>
        // --- VARIABLES GLOBALES DEL 3D ---
        let scene, camera, renderer, stars, bouquetGroup;
        let flores = []; // Array para guardar las flores 3D
        let animationId;
        let bouquetRevealed = false;

        // --- INICIALIZACIN DEL MUNDO 3D ---
        function init3D() {
            // 1. Escena y C谩mara
            scene = new THREE.Scene();
            scene.fog = new THREE.FogExp2(0x000000, 0.001); // Niebla negra para profundidad

            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.z = 5; // Posici贸n inicial de la c谩mara

            // 2. Renderizador
            renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(window.devicePixelRatio);
            document.getElementById('canvas-container').appendChild(renderer.domElement);

            // 3. Iluminaci贸n
            const ambientLight = new THREE.AmbientLight(0x404040, 2); // Luz ambiental suave
            scene.add(ambientLight);
            const pointLight = new THREE.PointLight(0xff69b4, 1.5, 50); // Luz rosa central
            pointLight.position.set(0, 2, 2);
            scene.add(pointLight);

            // 4. Crear la Galaxia (Fondo de estrellas)
            createGalaxyParticles();

            // 5. Preparar el Ramo (pero escondido)
            createHiddenBouquet();

            // Iniciar el bucle de animaci贸n principal
            animate();
        }

        // --- FUNCIN PARA CREAR LA GALAXIA ---
        function createGalaxyParticles() {
            const particlesGeometry = new THREE.BufferGeometry();
            const particlesCount = 5000; // Cantidad de estrellas
            const posArray = new Float32Array(particlesCount * 3);

            for(let i = 0; i < particlesCount * 3; i++) {
                // Esparcir estrellas en un espacio grande
                posArray[i] = (Math.random() - 0.5) * 100;
            }

            particlesGeometry.setAttribute('position', new THREE.BufferAttribute(posArray, 3));

            // Material de las estrellas (puntitos brillantes)
            const particlesMaterial = new THREE.PointsMaterial({
                size: 0.05,
                color: 0xffffff,
                transparent: true,
                opacity: 0.8,
                blending: THREE.AdditiveBlending
            });

            stars = new THREE.Points(particlesGeometry, particlesMaterial);
            scene.add(stars);
        }

        // --- FUNCIN PARA CREAR EL RAMO 3D (ESCONDIDO INICIALMENTE) ---
        function createHiddenBouquet() {
            bouquetGroup = new THREE.Group();
            bouquetGroup.position.y = -1; // Bajarlo un poco
            scene.add(bouquetGroup);

            // Colores de rosa (rojos, rosados, fucsias)
            const colors = [0xff0000, 0xff69b4, 0xdc143c, 0xff1493, 0xc71585];
            const totalFlores = 150;

            // Usamos IcosahedronGeometry para una forma de "flor low-poly"
            const geometryBase = new THREE.IcosahedronGeometry(0.1, 1);

            for (let i = 0; i < totalFlores; i++) {
                const material = new THREE.MeshPhongMaterial({
                    color: colors[Math.floor(Math.random() * colors.length)],
                    shininess: 100,
                    flatShading: true // Para que se vean las facetas como una joya/flor
                });

                const flor = new THREE.Mesh(geometryBase, material);

                // Posicionar las flores en forma de esfera/ramo usando coordenadas esf茅ricas
                const phi = Math.acos(-1 + (2 * i) / totalFlores);
                const theta = Math.sqrt(totalFlores * Math.PI) * phi;
                
                // Radio variable para darle volumen al ramo
                const radio = 1.5 + Math.random() * 0.5;

                flor.position.setFromSphericalCoords(radio, phi, theta);
                
                // Rotaci贸n aleatoria para variedad
                flor.rotation.set(Math.random()*Math.PI, Math.random()*Math.PI, Math.random()*Math.PI);

                // **ESTADO INICIAL: Escala 0 (Invisible)**
                flor.scale.set(0, 0, 0);

                bouquetGroup.add(flor);
                flores.push(flor); // Guardar referencia para animarla luego
            }
        }

        // --- BUCLE PRINCIPAL DE ANIMACIN 3D ---
        function animate() {
            animationId = requestAnimationFrame(animate);

            // Rotar la galaxia lentamente
            if(stars) stars.rotation.y += 0.0005;
            if(stars) stars.rotation.x += 0.0002;

            // Si el ramo ya apareci贸, rotarlo suavemente
            if (bouquetRevealed && bouquetGroup) {
                bouquetGroup.rotation.y += 0.002;
            }
            
            renderer.render(scene, camera);
        }

        // --- INTERACCIN DE USUARIO ---

        // 1. Funci贸n para revelar las flores UNA POR UNA
        function revelarFlorAFlor() {
            bouquetRevealed = true;
            let contador = 0;
            
            // Acercar la c谩mara un poco al ramo
            const targetZ = 3.5;
            const cameraInterval = setInterval(() => {
                if(camera.position.z > targetZ) camera.position.z -= 0.02;
                else clearInterval(cameraInterval);
            }, 20);

            // Intervalo para hacer crecer cada flor
            const intervaloAparicion = setInterval(() => {
                if (contador >= flores.length) {
                    clearInterval(intervaloAparicion); // Terminar cuando salgan todas
                    return;
                }

                const florActual = flores[contador];
                
                // Animaci贸n simple de escala de 0 a 1
                let escala = 0;
                const animacionCrecimiento = setInterval(() => {
                    escala += 0.05;
                    if (escala >= 1) {
                        florActual.scale.set(1, 1, 1);
                        clearInterval(animacionCrecimiento);
                    } else {
                        // Un peque帽o efecto de rebote al crecer
                        const scaleBounce = escala + Math.sin(escala * Math.PI) * 0.1;
                         florActual.scale.set(scaleBounce, scaleBounce, scaleBounce);
                    }
                }, 16); // ~60fps

                contador++;
            }, 40); // Aparece una flor nueva cada 40ms
        }

        // 2. Event Listeners para los botones
        document.getElementById('btnSi').addEventListener('click', () => {
            // Ocultar pregunta
            document.getElementById('pregunta').classList.add('hidden');
            // Mostrar mensaje final
            setTimeout(() => {
                document.getElementById('mensajeFinal').classList.remove('hidden');
                // ACTIVAR LA ANIMACIN DEL RAMO
                revelarFlorAFlor();
            }, 500);
        });

        // Bot贸n No escurridizo
        const btnNo = document.getElementById('btnNo');
        btnNo.addEventListener('mouseover', () => {
            const containerRect = document.getElementById('ui-container').getBoundingClientRect();
            const btnRect = btnNo.getBoundingClientRect();
            
            // Mover dentro de l铆mites seguros
            const newX = (Math.random() - 0.5) * (containerRect.width - btnRect.width * 2);
            const newY = (Math.random() - 0.5) * (containerRect.height - btnRect.height * 2);
            
            btnNo.style.transform = `translate(${newX}px, ${newY}px)`;
        });

        // Manejar el redimensionamiento de la ventana
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

        // INICIAR TODO
        init3D();

    </script>
</body>
</html>
